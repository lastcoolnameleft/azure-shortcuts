## Stop all VM's in a Resource Group
## Usage:  azStopRG kubernetes
azStopRG() {
    echo "Stopping $1";
    az vmss list -g $1 | jq '.[] | .name' | xargs -n 1 az vmss start -g $1 -n;
    az vm list -g $1 | jq '.[] | .name' | xargs -n 1 az vm stop -g $1 -n;
}

## Start all VM's in a Resource Group
## Usage:  azStartRG kubernetes
azStartRG() {
    echo "Starting $1";
    az vm list -g $1 | jq '.[] | .name' | xargs -n 1 az vm start -g $1 -n;
    az vmss list -g $1 | jq '.[] | .name' | xargs -n 1 az vmss start -g $1 -n;
}

## Start SSH proxy to DCOS mgmt
## Usage: dcosStartProxy my-mgmt-host.azure.com
dcosStartProxy() {
    echo "Creating SSH Proxy tunnel to $1";
    sudo ssh -fNL 80:localhost:80 -p 2200 azureuser@$1;
}

dcosStart() {
    echo "Starting DCOS for $1";
    azStopRG $1
    dcosStartProxy
}

dcosStop() {
    echo "Stopping DCOS for $1";
    azStopRG $1
}
